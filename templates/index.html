{% extends "base.html" %}
{% block title %}Helios ‚Äî Smart Contract Allocation Protocol{% endblock %}
{% block og_title %}Helios ‚Äî Gold-Backed Smart Contract Protocol{% endblock %}
{% block og_description %}A smart-contract-governed allocation protocol. Fiat converts to stablecoins, stablecoins acquire physical gold, members receive digital gold certificates distributed through autonomous contracts.{% endblock %}
{% block og_url %}/{% endblock %}

{% block content %}
<!-- ‚ïê‚ïê‚ïê LAUNCH BANNER ‚ïê‚ïê‚ïê -->
<div style="background:linear-gradient(90deg,rgba(41,151,255,.06),rgba(191,90,242,.04));border-bottom:1px solid rgba(41,151,255,.15);padding:.7rem 1rem;text-align:center;">
    <a href="/launch" style="color:var(--gold);text-decoration:none;font-family:'Inter',sans-serif;font-size:.85rem;font-weight:600;letter-spacing:.01em;">
        üöÄ HLS Token Offering Now Live ‚Äî Founding Members Get $0.05/Token ¬∑ Founding Price
        <span style="display:inline-block;margin-left:.6rem;background:linear-gradient(135deg,#2997ff,#bf5af2);color:#fff;font-size:.65rem;padding:2px 8px;border-radius:980px;vertical-align:middle;letter-spacing:.04em;">FOUNDING BONUS</span>
    </a>
</div>

<!-- ‚ïê‚ïê‚ïê HERO ‚ïê‚ïê‚ïê -->
<section class="hero">
    <div class="hero-content">
        <div class="coin-container">
            <svg class="helios-coin" viewBox="0 0 240 240" xmlns="http://www.w3.org/2000/svg">
                <defs>
                    <radialGradient id="coinGrad" cx="50%" cy="40%" r="55%">
                        <stop offset="0%" style="stop-color:#e5e5ea"/>
                        <stop offset="30%" style="stop-color:#d1d1d6"/>
                        <stop offset="60%" style="stop-color:#a1a1a6"/>
                        <stop offset="100%" style="stop-color:#48484a"/>
                    </radialGradient>
                    <filter id="coinGlow">
                        <feGaussianBlur stdDeviation="6" result="blur"/>
                        <feMerge><feMergeNode in="blur"/><feMergeNode in="SourceGraphic"/></feMerge>
                    </filter>
                    <radialGradient id="innerGrad" cx="50%" cy="40%" r="50%">
                        <stop offset="0%" style="stop-color:#f5f5f7"/>
                        <stop offset="50%" style="stop-color:#a1a1a6"/>
                        <stop offset="100%" style="stop-color:#636366"/>
                    </radialGradient>
                    <linearGradient id="ringGrad" x1="0" y1="0" x2="1" y2="1">
                        <stop offset="0%" style="stop-color:#64d2ff"/>
                        <stop offset="50%" style="stop-color:#2997ff"/>
                        <stop offset="100%" style="stop-color:#bf5af2"/>
                    </linearGradient>
                </defs>
                <!-- Outer iridescent ring -->
                <circle cx="120" cy="120" r="115" fill="none" stroke="url(#ringGrad)" stroke-width="2.5" filter="url(#coinGlow)" opacity="0.6"/>
                <!-- Main titanium disc -->
                <circle cx="120" cy="120" r="108" fill="url(#coinGrad)" filter="url(#coinGlow)"/>
                <!-- Inner ring -->
                <circle cx="120" cy="120" r="95" fill="none" stroke="rgba(255,255,255,0.1)" stroke-width="0.8"/>
                <!-- Inner glow -->
                <circle cx="120" cy="120" r="88" fill="url(#innerGrad)" opacity="0.08"/>
                <!-- Center core -->
                <circle cx="120" cy="120" r="32" fill="none" stroke="rgba(41,151,255,0.3)" stroke-width="0.8"/>
                <circle cx="120" cy="120" r="8" fill="#2997ff" opacity="0.8"/>
                <!-- Pentagon constellation -->
                <g opacity="0.3">
                    <circle cx="120" cy="80" r="3" fill="#64d2ff"/>
                    <circle cx="158" cy="103" r="3" fill="#2997ff"/>
                    <circle cx="144" cy="148" r="3" fill="#bf5af2"/>
                    <circle cx="96" cy="148" r="3" fill="#2997ff"/>
                    <circle cx="82" cy="103" r="3" fill="#64d2ff"/>
                    <line x1="120" y1="80" x2="158" y2="103" stroke="url(#ringGrad)" stroke-width="0.5" opacity="0.6"/>
                    <line x1="158" y1="103" x2="144" y2="148" stroke="url(#ringGrad)" stroke-width="0.5" opacity="0.6"/>
                    <line x1="144" y1="148" x2="96" y2="148" stroke="url(#ringGrad)" stroke-width="0.5" opacity="0.6"/>
                    <line x1="96" y1="148" x2="82" y2="103" stroke="url(#ringGrad)" stroke-width="0.5" opacity="0.6"/>
                    <line x1="82" y1="103" x2="120" y2="80" stroke="url(#ringGrad)" stroke-width="0.5" opacity="0.6"/>
                </g>
            </svg>
        </div>

        <h1 class="hero-title">HELIOS</h1>
        <p class="hero-tagline">
            One activation. Your dollars convert to stablecoins, acquire physical gold,
            and generate gold-backed certificates‚Äîall governed by immutable smart contracts
            on XRPL‚Äâ/‚ÄâStellar. No human discretion. Just autonomous code.
        </p>
        <p class="hero-rule" style="color:var(--metal);font-weight:600;letter-spacing:.12em;font-size:.85rem;">SMART CONTRACTS &middot; GOLD-BACKED &middot; CRYPTO ACCESS &middot; ON-CHAIN VERIFIED</p>

        <div class="hero-actions">
            <a href="/activate" class="btn btn-primary btn-lg">Activate Your Contract</a>
            <a href="/earnings" class="btn btn-ghost btn-lg">View Smart Contracts</a>
        </div>
    </div>
    <canvas id="neural-bg" class="hero-neural-bg"></canvas>
</section>

<!-- ‚ïê‚ïê‚ïê THE HELIOS FLOWLINE ‚ïê‚ïê‚ïê -->
<section class="section section-dark">
    <div class="container" style="max-width:960px;">
        <h2 style="text-align:center;">The Helios Flowline</h2>
        <p class="section-subtitle" style="max-width:680px;margin:0 auto 2.5rem;">
            Follow the Flowline. Watch value move through the protocol in real time ‚Äî
            from contract activation to gold-backed certificates distributed through smart contracts.
        </p>

        <!-- Flowline Animation Container -->
        <div class="flowline-wrap">
            <svg class="flowline-svg" viewBox="0 0 920 120" preserveAspectRatio="xMidYMid meet" xmlns="http://www.w3.org/2000/svg">
                <defs>
                    <linearGradient id="fl-grad" x1="0%" y1="0%" x2="100%" y2="0%">
                        <stop offset="0%" stop-color="#2997ff" stop-opacity="0"/>
                        <stop offset="40%" stop-color="#2997ff" stop-opacity="1"/>
                        <stop offset="60%" stop-color="#64d2ff" stop-opacity="1"/>
                        <stop offset="100%" stop-color="#2997ff" stop-opacity="0"/>
                    </linearGradient>
                    <filter id="fl-glow">
                        <feGaussianBlur stdDeviation="4" result="blur"/>
                        <feMerge>
                            <feMergeNode in="blur"/>
                            <feMergeNode in="SourceGraphic"/>
                        </feMerge>
                    </filter>
                    <filter id="fl-glow-strong">
                        <feGaussianBlur stdDeviation="8" result="blur"/>
                        <feMerge>
                            <feMergeNode in="blur"/>
                            <feMergeNode in="SourceGraphic"/>
                        </feMerge>
                    </filter>
                </defs>

                <!-- Track line (dim base) -->
                <line x1="92" y1="60" x2="828" y2="60" stroke="rgba(41,151,255,0.08)" stroke-width="2"/>

                <!-- Segment lines (light up per step) -->
                <line class="fl-seg" data-seg="1" x1="92" y1="60" x2="276" y2="60" stroke="rgba(41,151,255,0.04)" stroke-width="2.5"/>
                <line class="fl-seg" data-seg="2" x1="276" y1="60" x2="460" y2="60" stroke="rgba(41,151,255,0.04)" stroke-width="2.5"/>
                <line class="fl-seg" data-seg="3" x1="460" y1="60" x2="644" y2="60" stroke="rgba(41,151,255,0.04)" stroke-width="2.5"/>
                <line class="fl-seg" data-seg="4" x1="644" y1="60" x2="828" y2="60" stroke="rgba(41,151,255,0.04)" stroke-width="2.5"/>

                <!-- Electricity bolt (the moving element) -->
                <rect class="fl-bolt" x="0" y="56" width="60" height="8" rx="4" fill="url(#fl-grad)" filter="url(#fl-glow-strong)" opacity="0"/>

                <!-- Node circles -->
                <circle class="fl-node" data-step="0" cx="92"  cy="60" r="18" fill="var(--bg-card)" stroke="rgba(41,151,255,0.2)" stroke-width="2"/>
                <circle class="fl-node" data-step="1" cx="276" cy="60" r="18" fill="var(--bg-card)" stroke="rgba(41,151,255,0.2)" stroke-width="2"/>
                <circle class="fl-node" data-step="2" cx="460" cy="60" r="18" fill="var(--bg-card)" stroke="rgba(41,151,255,0.2)" stroke-width="2"/>
                <circle class="fl-node" data-step="3" cx="644" cy="60" r="18" fill="var(--bg-card)" stroke="rgba(41,151,255,0.2)" stroke-width="2"/>
                <circle class="fl-node" data-step="4" cx="828" cy="60" r="18" fill="var(--bg-card)" stroke="rgba(41,151,255,0.2)" stroke-width="2"/>

                <!-- Step numbers -->
                <text class="fl-num" data-step="0" x="92"  y="65" text-anchor="middle" fill="rgba(41,151,255,0.35)" font-family="Inter,sans-serif" font-size="14" font-weight="700">1</text>
                <text class="fl-num" data-step="1" x="276" y="65" text-anchor="middle" fill="rgba(41,151,255,0.35)" font-family="Inter,sans-serif" font-size="14" font-weight="700">2</text>
                <text class="fl-num" data-step="2" x="460" y="65" text-anchor="middle" fill="rgba(41,151,255,0.35)" font-family="Inter,sans-serif" font-size="14" font-weight="700">3</text>
                <text class="fl-num" data-step="3" x="644" y="65" text-anchor="middle" fill="rgba(41,151,255,0.35)" font-family="Inter,sans-serif" font-size="14" font-weight="700">4</text>
                <text class="fl-num" data-step="4" x="828" y="65" text-anchor="middle" fill="rgba(41,151,255,0.35)" font-family="Inter,sans-serif" font-size="14" font-weight="700">5</text>
            </svg>

            <!-- Step labels (below SVG) -->
            <div class="flowline-labels">
                <div class="fl-label" data-step="0">
                    <div class="fl-label-icon">‚ö°</div>
                    <h4>Contract Activation</h4>
                    <p>Choose your amount ‚Äî $100 to $5,000. One payment activates your smart contract on-chain.</p>
                </div>
                <div class="fl-label" data-step="1">
                    <div class="fl-label-icon">üí±</div>
                    <h4>Fiat ‚Üí Stablecoin</h4>
                    <p>Dollars convert to USDC/USDT on XRPL or Stellar. Transparent, auditable settlement.</p>
                </div>
                <div class="fl-label" data-step="2">
                    <div class="fl-label-icon">ü•á</div>
                    <h4>Stablecoin ‚Üí Gold</h4>
                    <p>Stablecoins acquire physical gold by weight through APMEX. Verified. Vaulted.</p>
                </div>
                <div class="fl-label" data-step="3">
                    <div class="fl-label-icon">üìú</div>
                    <h4>Gold ‚Üí Certificates</h4>
                    <p>Gold is tokenized into NFT certificates on XRPL. Each one represents real metal.</p>
                </div>
                <div class="fl-label" data-step="4">
                    <div class="fl-label-icon">üî∫</div>
                    <h4>Smart Contract Distribution</h4>
                    <p>Certificates distribute through autonomous contracts. Fixed formula. No discretion. Pure code.</p>
                </div>
            </div>
        </div>
    </div>
</section>

<style>
/* ‚ïê‚ïê‚ïê FLOWLINE ‚ïê‚ïê‚ïê */
.flowline-wrap { position:relative; padding:1rem 0 0; }
.flowline-svg { width:100%; height:auto; display:block; }
.flowline-labels { display:grid; grid-template-columns:repeat(5,1fr); gap:.5rem; margin-top:1rem; }
.fl-label { text-align:center; padding:.5rem .3rem; opacity:.35; transition:opacity .6s ease, transform .6s ease; transform:translateY(6px); }
.fl-label.active { opacity:1; transform:translateY(0); }
.fl-label-icon { font-size:1.4rem; margin-bottom:.3rem; }
.fl-label h4 { font-size:.82rem; color:var(--blue); margin-bottom:.25rem; font-family:'Inter',sans-serif; letter-spacing:.02em; }
.fl-label p { font-size:.74rem; color:var(--text-muted); line-height:1.5; margin:0; }

/* Node activation states */
.fl-node { transition: stroke .4s ease, fill .4s ease; }
.fl-node.lit { stroke:var(--blue); stroke-width:2.5; fill:rgba(41,151,255,.1); filter:url(#fl-glow); }
.fl-num { transition: fill .4s ease; }
.fl-num.lit { fill:var(--blue); }
.fl-seg { transition: stroke .5s ease; }
.fl-seg.lit { stroke:var(--blue); stroke-opacity:.6; }

/* Pulse ring on active node */
@keyframes fl-ring-pulse {
    0% { r:18; stroke-opacity:.6; }
    100% { r:30; stroke-opacity:0; }
}
.fl-ring { animation: fl-ring-pulse 1.2s ease-out forwards; }

/* Responsive: stack labels on mobile */
@media(max-width:640px){
    .flowline-labels { grid-template-columns:1fr; gap:1.2rem; }
    .fl-label { text-align:left; display:flex; gap:.8rem; align-items:flex-start; padding:.3rem 0; }
    .fl-label-icon { flex-shrink:0; margin:0; }
    .fl-label h4 { font-size:.88rem; }
    .fl-label p { font-size:.8rem; }
    .flowline-svg { display:none; }
    .fl-label { opacity:1; transform:none; }
}
</style>

<!-- ‚ïê‚ïê‚ïê THE MATH MODEL ‚ïê‚ïê‚ïê -->
<section class="section">
    <div class="container" style="max-width:960px;">
        <h2 style="text-align:center;">Smart Contract Propagation Function</h2>
        <p class="section-subtitle" style="max-width:640px;margin:0 auto 2rem;">
            All distributions are governed by an immutable function deployed on-chain.
            No interpretation. No adjustment. The contract is the protocol.
        </p>

        <div style="background:var(--bg-card);border:1px solid var(--border);border-radius:var(--radius);padding:2.5rem;text-align:center;margin-bottom:2rem;">
            <div class="math-formula">
                W<sub>h</sub>&ensp;=&ensp;W<sub>1</sub>&ensp;&middot;&ensp;r<sup>(h&minus;1)</sup>
            </div>
            <div style="display:flex;gap:2rem;justify-content:center;flex-wrap:wrap;margin-top:1.5rem;">
                <div style="text-align:center;">
                    <div style="font-size:.75rem;color:var(--text-muted);text-transform:uppercase;letter-spacing:.08em;font-family:'Inter',sans-serif;">W<sub>1</sub></div>
                    <div style="font-size:1.3rem;font-weight:700;color:var(--gold);">50%</div>
                    <div style="font-size:.78rem;color:var(--text-muted);">Direct connection</div>
                </div>
                <div style="text-align:center;">
                    <div style="font-size:.75rem;color:var(--text-muted);text-transform:uppercase;letter-spacing:.08em;font-family:'Inter',sans-serif;">r</div>
                    <div style="font-size:1.3rem;font-weight:700;color:var(--gold);">0.5</div>
                    <div style="font-size:.78rem;color:var(--text-muted);">Decay constant</div>
                </div>
                <div style="text-align:center;">
                    <div style="font-size:.75rem;color:var(--text-muted);text-transform:uppercase;letter-spacing:.08em;font-family:'Inter',sans-serif;">h</div>
                    <div style="font-size:1.3rem;font-weight:700;color:var(--gold);">Hop</div>
                    <div style="font-size:.78rem;color:var(--text-muted);">Connection distance</div>
                </div>
            </div>

            <div style="margin-top:2rem;border-top:1px solid var(--border);padding-top:1.5rem;">
                <div style="display:grid;grid-template-columns:repeat(5,1fr);gap:.5rem;max-width:500px;margin:0 auto;">
                    <div style="text-align:center;">
                        <div style="font-size:.65rem;color:var(--text-muted);font-family:'Inter',sans-serif;">Hop 1</div>
                        <div style="font-size:1.1rem;font-weight:700;color:var(--gold);">50%</div>
                    </div>
                    <div style="text-align:center;">
                        <div style="font-size:.65rem;color:var(--text-muted);font-family:'Inter',sans-serif;">Hop 2</div>
                        <div style="font-size:1.1rem;font-weight:700;color:var(--text);">25%</div>
                    </div>
                    <div style="text-align:center;">
                        <div style="font-size:.65rem;color:var(--text-muted);font-family:'Inter',sans-serif;">Hop 3</div>
                        <div style="font-size:1.1rem;font-weight:700;color:var(--text);">12.5%</div>
                    </div>
                    <div style="text-align:center;">
                        <div style="font-size:.65rem;color:var(--text-muted);font-family:'Inter',sans-serif;">Hop 4</div>
                        <div style="font-size:1.1rem;font-weight:700;color:var(--text);">6.25%</div>
                    </div>
                    <div style="text-align:center;">
                        <div style="font-size:.65rem;color:var(--text-muted);font-family:'Inter',sans-serif;">Hop n</div>
                        <div style="font-size:1.1rem;font-weight:700;color:var(--text-muted);">~0%</div>
                    </div>
                </div>
            </div>
        </div>

        <p style="text-align:center;">
            <a href="/earnings" class="btn btn-ghost">View Complete Smart Contract Model</a>
        </p>
    </div>
</section>

<!-- ‚ïê‚ïê‚ïê WEB3 INFRASTRUCTURE ‚ïê‚ïê‚ïê -->
<section class="section section-dark">
    <div class="container" style="max-width:960px;">
        <h2 style="text-align:center;">Web3 Settlement Infrastructure</h2>
        <p class="section-subtitle" style="max-width:640px;margin:0 auto 2rem;">
            Helios settles on two complementary blockchains, chosen for speed, compliance,
            and institutional-grade settlement guarantees.
        </p>

        <div class="principle-grid" style="grid-template-columns:1fr 1fr;max-width:800px;margin:0 auto;">
            <div class="principle-card">
                <h3 style="color:var(--gold);font-size:1.2rem;margin-bottom:.75rem;">XRPL</h3>
                <ul style="list-style:none;padding:0;">
                    <li style="color:var(--text-muted);font-size:.92rem;padding:.35rem 0;border-bottom:1px solid var(--border);">3‚Äì5 second settlement finality</li>
                    <li style="color:var(--text-muted);font-size:.92rem;padding:.35rem 0;border-bottom:1px solid var(--border);">Near-zero transaction fees</li>
                    <li style="color:var(--text-muted);font-size:.92rem;padding:.35rem 0;border-bottom:1px solid var(--border);">Native NFT support for certificates</li>
                    <li style="color:var(--text-muted);font-size:.92rem;padding:.35rem 0;">Trustline-based asset issuance</li>
                </ul>
            </div>
            <div class="principle-card">
                <h3 style="color:var(--gold);font-size:1.2rem;margin-bottom:.75rem;">Stellar</h3>
                <ul style="list-style:none;padding:0;">
                    <li style="color:var(--text-muted);font-size:.92rem;padding:.35rem 0;border-bottom:1px solid var(--border);">Stablecoin liquidity (USDC native)</li>
                    <li style="color:var(--text-muted);font-size:.92rem;padding:.35rem 0;border-bottom:1px solid var(--border);">Regulated USD on/off ramps</li>
                    <li style="color:var(--text-muted);font-size:.92rem;padding:.35rem 0;border-bottom:1px solid var(--border);">Anchor integration for fiat conversion</li>
                    <li style="color:var(--text-muted);font-size:.92rem;padding:.35rem 0;">Institutional compliance framework</li>
                </ul>
            </div>
        </div>
    </div>
</section>

<!-- ‚ïê‚ïê‚ïê DIGITAL CERTIFICATES ‚ïê‚ïê‚ïê -->
<section class="section">
    <div class="container" style="max-width:960px;">
        <h2 style="text-align:center;">Gold-Backed Digital Certificates</h2>
        <p class="section-subtitle" style="max-width:640px;margin:0 auto 2rem;">
            All value within the protocol is represented by digital certificates ‚Äî each backed by
            a verifiable weight of physical gold, issued as NFTs on XRPL.
        </p>

        <div class="principle-grid">
            <div class="principle-card" style="text-align:center;border-top:2px solid var(--gold);">
                <h3 style="color:var(--gold);font-size:1.15rem;margin-bottom:.5rem;">Gold Certificates</h3>
                <p style="font-weight:600;margin-bottom:.5rem;font-size:.9rem;">Primary Value Instrument</p>
                <p>Represent allocated gold weight. Redeemable for physical metal from APMEX
                or convertible to stablecoin. Each certificate carries a SHA-256 proof of custody
                anchored on XRPL.</p>
            </div>
            <div class="principle-card" style="text-align:center;border-top:2px solid var(--green);">
                <h3 style="color:var(--green);font-size:1.15rem;margin-bottom:.5rem;">Welcome Certificates</h3>
                <p style="font-weight:600;margin-bottom:.5rem;font-size:.9rem;">Activity-Based Allocation</p>
                <p>Issued at enrollment (Welcome Allocation), upon direct connection activation (Connection Reward),
                and based on participation metrics (Engagement Reward). Fixed rules, no discretion.</p>
            </div>
            <div class="principle-card" style="text-align:center;border-top:2px solid var(--blue);">
                <h3 style="color:var(--blue);font-size:1.15rem;margin-bottom:.5rem;">Staking Certificates</h3>
                <p style="font-weight:600;margin-bottom:.5rem;font-size:.9rem;">Lock Duration Rewards</p>
                <p>Members may lock certificates for a defined period to receive additional allocation rewards.
                Longer lock durations yield higher reward multipliers. All terms are protocol-enforced.</p>
            </div>
        </div>

        <p style="text-align:center;margin-top:1.5rem;">
            <a href="/certificates" class="btn btn-ghost">Certificate Details &amp; Redemption</a>
        </p>
    </div>
</section>

<!-- ‚ïê‚ïê‚ïê MEMBERSHIP STRUCTURE ‚ïê‚ïê‚ïê -->
<section class="section section-dark">
    <div class="container" style="max-width:960px;">
        <h2 style="text-align:center;">Neuromorphic Protocol Mesh</h2>
        <p class="section-subtitle" style="max-width:640px;margin:0 auto 2rem;">
            Every participant is a node. Every connection is a synapse. Smart contracts
            propagate value through the mesh autonomously ‚Äî no hierarchy, no positions, just code.
        </p>

        <!-- 3D Neuromorphic Canvas -->
        <div style="position:relative;width:100%;max-width:800px;margin:0 auto 2rem;border-radius:var(--radius);overflow:hidden;border:1px solid var(--border);">
            <canvas id="neuro-mesh" style="width:100%;height:420px;display:block;background:var(--bg);"></canvas>
            <div style="position:absolute;bottom:1rem;left:50%;transform:translateX(-50%);display:flex;gap:1.5rem;">
                <div style="display:flex;align-items:center;gap:.4rem;">
                    <div style="width:8px;height:8px;border-radius:50%;background:var(--blue);"></div>
                    <span style="font-family:'Inter',sans-serif;font-size:.65rem;color:var(--text-muted);">Active Node</span>
                </div>
                <div style="display:flex;align-items:center;gap:.4rem;">
                    <div style="width:16px;height:2px;background:rgba(41,151,255,.3);border-radius:1px;"></div>
                    <span style="font-family:'Inter',sans-serif;font-size:.65rem;color:var(--text-muted);">Synapse</span>
                </div>
                <div style="display:flex;align-items:center;gap:.4rem;">
                    <div style="width:8px;height:8px;border-radius:50%;background:#64d2ff;box-shadow:0 0 6px #64d2ff;"></div>
                    <span style="font-family:'Inter',sans-serif;font-size:.65rem;color:var(--text-muted);">Signal</span>
                </div>
            </div>
        </div>

        <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:1rem;max-width:800px;margin:0 auto 2rem;">
            <div style="background:var(--bg);border:1px solid var(--border);border-radius:var(--radius);padding:1.5rem;text-align:center;">
                <div style="font-size:1.5rem;font-weight:700;color:var(--gold);font-family:'Inter',sans-serif;">XRPL</div>
                <div style="font-size:.85rem;color:var(--text-muted);margin-top:.3rem;">Settlement chain</div>
            </div>
            <div style="background:var(--bg);border:1px solid var(--border);border-radius:var(--radius);padding:1.5rem;text-align:center;">
                <div style="font-size:1.5rem;font-weight:700;color:var(--gold);font-family:'Inter',sans-serif;">Stellar</div>
                <div style="font-size:.85rem;color:var(--text-muted);margin-top:.3rem;">Stablecoin layer</div>
            </div>
            <div style="background:var(--bg);border:1px solid var(--border);border-radius:var(--radius);padding:1.5rem;text-align:center;">
                <div style="font-size:1.5rem;font-weight:700;color:var(--gold);font-family:'Inter',sans-serif;">Gold</div>
                <div style="font-size:.85rem;color:var(--text-muted);margin-top:.3rem;">Physical backing</div>
            </div>
            <div style="background:var(--bg);border:1px solid var(--border);border-radius:var(--radius);padding:1.5rem;text-align:center;">
                <div style="font-size:1.5rem;font-weight:700;color:var(--gold);font-family:'Inter',sans-serif;">BTC/ETH</div>
                <div style="font-size:.85rem;color:var(--text-muted);margin-top:.3rem;">Crypto access</div>
            </div>
        </div>

        <div style="text-align:center;">
            <a href="/earnings" class="btn btn-primary">View Full Smart Contract Model</a>
            <a href="/treasury" class="btn btn-ghost" style="margin-left:.5rem;">Treasury &amp; Reserves</a>
        </div>
    </div>
</section>

<!-- ‚ïê‚ïê‚ïê .HELIOS NAMESPACE ‚ïê‚ïê‚ïê -->
<section class="section">
    <div class="container" style="max-width:800px;text-align:center;">
        <h2>.helios Member Identity</h2>
        <p class="section-subtitle" style="max-width:560px;margin:0 auto 1.5rem;">
            A decentralized namespace for identity, certificate ownership,
            and protocol connectivity. Not a gamified handle ‚Äî a smart-contract identity layer
            anchored on XRPL.
        </p>
        <div style="background:var(--bg-card);border:1px solid var(--border);border-radius:var(--radius);padding:1.5rem;display:inline-block;">
            <span style="font-family:'Inter',monospace;font-size:1.3rem;color:var(--gold);font-weight:600;">member.helios</span>
            <span style="display:block;font-size:.78rem;color:var(--text-muted);margin-top:.3rem;">Identity &middot; Certificates &middot; Connections &middot; Settlement History</span>
        </div>
    </div>
</section>

<!-- ‚ïê‚ïê‚ïê MEMBER ADVISORY CTA ‚ïê‚ïê‚ïê -->
<section class="section section-dark" style="text-align:center;">
    <div class="container" style="max-width:700px;">
        <h2>Questions About the Protocol?</h2>
        <p class="section-subtitle" style="max-width:520px;margin:0 auto 1.5rem;">
            Our AI-powered Member Advisory provides detailed information on the allocation formula,
            certificate mechanics, Web3 infrastructure, staking terms, and membership process.
        </p>
        <a href="/ask" class="btn btn-primary btn-lg">Speak with an Advisor</a>
    </div>
</section>


<!-- ‚ïê‚ïê‚ïê HELIOS FORTUNE SPIN ‚Äî GAMIFICATION ENGINE ‚ïê‚ïê‚ïê -->
<section class="section section-dark" id="fortune-section">
    <div class="container" style="max-width:700px;text-align:center;">
        <h2 style="margin-bottom:.3rem;">Helios Fortune Spin</h2>
        <p class="section-subtitle" style="max-width:520px;margin:0 auto 1.5rem;">
            Every founding member gets one spin. Win token bonuses, certificate upgrades,
            NFT drops, and exclusive rewards. Your fortune is waiting.
        </p>

        <!-- Spin Wheel -->
        <div style="position:relative;width:320px;height:320px;margin:0 auto 1.5rem;">
            <!-- Pointer -->
            <div style="position:absolute;top:-8px;left:50%;transform:translateX(-50%);z-index:10;font-size:1.5rem;filter:drop-shadow(0 2px 4px rgba(0,0,0,.5));">&#9660;</div>
            <canvas id="fortune-wheel" width="320" height="320" style="border-radius:50%;cursor:pointer;"></canvas>
        </div>

        <button id="spin-btn" onclick="spinWheel()" style="
            padding:.75rem 2.5rem;border-radius:var(--radius-sm);
            background:var(--gold);color:var(--bg);border:none;
            font-weight:700;font-size:1rem;font-family:'Inter',sans-serif;
            cursor:pointer;transition:all .25s;letter-spacing:.02em;
        ">&#127920; SPIN TO WIN</button>
        <p id="spin-status" style="font-size:.78rem;color:var(--text-muted);margin-top:.8rem;min-height:1.5em;"></p>

        <!-- Prize reveal (hidden until win) -->
        <div id="prize-reveal" style="display:none;margin-top:1.2rem;padding:1.2rem;background:var(--bg-card);border:1px solid var(--gold);border-radius:var(--radius);animation:prizeReveal .5s ease;">
            <div id="prize-icon" style="font-size:2.5rem;margin-bottom:.5rem;"></div>
            <div id="prize-title" style="font-size:1.1rem;font-weight:700;color:var(--gold);margin-bottom:.3rem;"></div>
            <div id="prize-desc" style="font-size:.85rem;color:var(--text-muted);margin-bottom:1rem;line-height:1.5;"></div>
            <a href="/activate" id="prize-cta" style="
                display:inline-block;padding:.65rem 2rem;
                background:var(--gold);color:var(--bg);border-radius:var(--radius-sm);
                font-weight:700;font-size:.92rem;text-decoration:none;transition:all .25s;
            ">Claim Your Bonus &mdash; Activate Now &rarr;</a>
        </div>
    </div>
</section>
<style>
@keyframes prizeReveal { from{opacity:0;transform:scale(.9)} to{opacity:1;transform:scale(1)} }
</style>

<!-- ‚ïê‚ïê‚ïê FINAL CTA ‚ïê‚ïê‚ïê -->
<section class="section section-cta">
    <div class="container">
        <h2>Gold-backed certificates. Crypto access.<br>Smart contract ‚Äî governed allocation.</h2>
        <p class="cta-sub" style="font-size:.95rem;max-width:540px;margin:.5rem auto 1.5rem;">
            No hype. No discretion. No hidden fees.<br>
            Activate your contract and let the code do the rest.
        </p>
        <div class="hero-actions">
            <a href="/activate" class="btn btn-primary btn-lg">Activate Your Contract &mdash; Claim Your Bonus</a>
            <a href="/certificates" class="btn btn-ghost btn-lg">View Certificate Types</a>
        </div>
    </div>
</section>
{% endblock %}

{% block scripts %}
<script>
// ‚ïê‚ïê‚ïê THE HELIOS FLOWLINE ‚Äî Electricity Animation ‚ïê‚ïê‚ïê
(function(){
    var svg = document.querySelector('.flowline-svg');
    if(!svg) return;

    var nodes = svg.querySelectorAll('.fl-node');
    var nums  = svg.querySelectorAll('.fl-num');
    var segs  = svg.querySelectorAll('.fl-seg');
    var bolt  = svg.querySelector('.fl-bolt');
    var labels = document.querySelectorAll('.fl-label');

    var stepCx = [92, 276, 460, 644, 828];
    var TOTAL_STEPS = 5;
    var TRAVEL_MS   = 800;   // time bolt takes to travel between nodes
    var HOLD_MS     = 1200;  // pause while node is active
    var RESET_MS    = 600;   // pause before restart
    var currentStep = -1;
    var boltWidth   = 60;

    function resetAll(){
        nodes.forEach(function(n){ n.classList.remove('lit'); });
        nums.forEach(function(n){ n.classList.remove('lit'); });
        segs.forEach(function(s){ s.classList.remove('lit'); });
        labels.forEach(function(l){ l.classList.remove('active'); });
        bolt.setAttribute('opacity','0');
        // remove old pulse rings
        svg.querySelectorAll('.fl-ring').forEach(function(r){ r.remove(); });
    }

    function activateNode(i){
        nodes[i].classList.add('lit');
        nums[i].classList.add('lit');
        labels[i].classList.add('active');
        // pulse ring
        var ring = document.createElementNS('http://www.w3.org/2000/svg','circle');
        ring.setAttribute('cx', stepCx[i]);
        ring.setAttribute('cy', 60);
        ring.setAttribute('r', 18);
        ring.setAttribute('fill','none');
        ring.setAttribute('stroke','#2997ff');
        ring.setAttribute('stroke-width','2');
        ring.classList.add('fl-ring');
        svg.appendChild(ring);
        setTimeout(function(){ if(ring.parentNode) ring.remove(); }, 1300);
    }

    function animateBolt(fromX, toX, cb){
        bolt.setAttribute('opacity','1');
        var startTime = null;
        function frame(ts){
            if(!startTime) startTime = ts;
            var p = Math.min((ts - startTime) / TRAVEL_MS, 1);
            // easeInOut
            var ease = p < 0.5 ? 2*p*p : 1 - Math.pow(-2*p+2,2)/2;
            var x = fromX + (toX - fromX) * ease - boltWidth/2;
            bolt.setAttribute('x', x);
            if(p < 1){
                requestAnimationFrame(frame);
            } else {
                bolt.setAttribute('opacity','0');
                if(cb) cb();
            }
        }
        requestAnimationFrame(frame);
    }

    function runStep(){
        currentStep++;
        if(currentStep >= TOTAL_STEPS){
            // loop: hold a beat, then reset and restart
            setTimeout(function(){
                resetAll();
                currentStep = -1;
                setTimeout(runStep, RESET_MS);
            }, HOLD_MS);
            return;
        }

        if(currentStep === 0){
            // first node: just activate, no bolt travel
            activateNode(0);
            setTimeout(runStep, HOLD_MS);
        } else {
            // light the connecting segment
            segs[currentStep - 1].classList.add('lit');
            // animate bolt from previous node to this one
            animateBolt(stepCx[currentStep-1], stepCx[currentStep], function(){
                activateNode(currentStep);
                setTimeout(runStep, HOLD_MS);
            });
        }
    }

    // Start when section scrolls into view (IntersectionObserver)
    var started = false;
    var observer = new IntersectionObserver(function(entries){
        if(entries[0].isIntersecting && !started){
            started = true;
            runStep();
        }
    }, { threshold: 0.3 });
    observer.observe(svg.closest('.flowline-wrap'));
})();

// ‚ïê‚ïê‚ïê Subtle Network Background Animation ‚ïê‚ïê‚ïê
(function() {
    var canvas = document.getElementById('neural-bg');
    if (!canvas) return;
    var ctx = canvas.getContext('2d');

    function resize() {
        var hero = canvas.parentElement;
        canvas.width = hero.clientWidth;
        canvas.height = hero.clientHeight;
    }
    resize();
    window.addEventListener('resize', resize);

    var nodes = [];
    var NODE_COUNT = 40;
    var MAX_DIST = 200;

    for (var i = 0; i < NODE_COUNT; i++) {
        nodes.push({
            x: Math.random() * canvas.width,
            y: Math.random() * canvas.height,
            vx: (Math.random() - 0.5) * 0.15,
            vy: (Math.random() - 0.5) * 0.15,
            r: Math.random() * 1.5 + 0.5,
            pulse: Math.random() * Math.PI * 2
        });
    }

    function draw() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        for (var i = 0; i < nodes.length; i++) {
            for (var j = i + 1; j < nodes.length; j++) {
                var dx = nodes[i].x - nodes[j].x;
                var dy = nodes[i].y - nodes[j].y;
                var dist = Math.sqrt(dx * dx + dy * dy);
                if (dist < MAX_DIST) {
                    var alpha = (1 - dist / MAX_DIST) * 0.08;
                    ctx.strokeStyle = 'rgba(41, 151, 255, ' + alpha + ')';
                    ctx.lineWidth = 0.4;
                    ctx.beginPath();
                    ctx.moveTo(nodes[i].x, nodes[i].y);
                    ctx.lineTo(nodes[j].x, nodes[j].y);
                    ctx.stroke();
                }
            }
        }
        var time = Date.now() * 0.001;
        for (var k = 0; k < nodes.length; k++) {
            var n = nodes[k];
            var pulse = Math.sin(time + n.pulse) * 0.5 + 0.5;
            var a = 0.1 + pulse * 0.15;
            ctx.fillStyle = 'rgba(41, 151, 255, ' + a + ')';
            ctx.beginPath();
            ctx.arc(n.x, n.y, n.r + pulse * 0.3, 0, Math.PI * 2);
            ctx.fill();
            n.x += n.vx;
            n.y += n.vy;
            if (n.x < 0 || n.x > canvas.width) n.vx *= -1;
            if (n.y < 0 || n.y > canvas.height) n.vy *= -1;
        }
        requestAnimationFrame(draw);
    }
    draw();
})();

// ‚ïê‚ïê‚ïê NEUROMORPHIC 3D MESH ‚Äî Smart Contract Visualization ‚ïê‚ïê‚ïê
(function(){
    var c = document.getElementById('neuro-mesh');
    if(!c) return;
    var ctx = c.getContext('2d');
    var W, H, cx, cy;

    function resize(){
        var r = c.getBoundingClientRect();
        c.width  = W = r.width * (window.devicePixelRatio > 1 ? 2 : 1);
        c.height = H = 420 * (window.devicePixelRatio > 1 ? 2 : 1);
        cx = W/2; cy = H/2;
        if(window.devicePixelRatio > 1){ ctx.scale(2,2); }
    }
    resize();

    // Generate nodes in a sphere
    var N = 70, nodes = [], edges = [], signals = [];
    var rotY = 0, rotX = 0.3, mouseX = 0, mouseInfluence = 0;

    for(var i=0; i<N; i++){
        // Fibonacci sphere distribution
        var phi = Math.acos(1 - 2*(i+0.5)/N);
        var theta = Math.PI * (1 + Math.sqrt(5)) * i;
        var rad = 130 + Math.random()*30;
        nodes.push({
            x: rad * Math.sin(phi) * Math.cos(theta),
            y: rad * Math.sin(phi) * Math.sin(theta) * 0.65,
            z: rad * Math.cos(phi),
            baseR: 2 + Math.random()*2.5,
            pulse: Math.random() * Math.PI * 2,
            active: Math.random() < 0.3
        });
    }

    // Build edges (connect nearby nodes)
    for(var i=0; i<N; i++){
        for(var j=i+1; j<N; j++){
            var dx=nodes[i].x-nodes[j].x, dy=nodes[i].y-nodes[j].y, dz=nodes[i].z-nodes[j].z;
            var d = Math.sqrt(dx*dx+dy*dy+dz*dz);
            if(d < 120) edges.push({a:i, b:j, d:d});
        }
    }

    // Signal particles traveling along edges
    function spawnSignal(){
        if(signals.length > 12) return;
        var e = edges[Math.floor(Math.random()*edges.length)];
        signals.push({ edge:e, t:0, speed:0.008+Math.random()*0.012, dir: Math.random()>0.5?1:-1 });
    }
    setInterval(spawnSignal, 400);

    // Mouse interaction
    c.addEventListener('mousemove', function(ev){
        var rect = c.getBoundingClientRect();
        mouseX = ((ev.clientX - rect.left) / rect.width - 0.5) * 2;
        mouseInfluence = 0.3;
    });
    c.addEventListener('mouseleave', function(){ mouseInfluence = 0; });

    // 3D projection
    function project(x, y, z){
        // Rotate Y
        var cosY = Math.cos(rotY), sinY = Math.sin(rotY);
        var x1 = x*cosY - z*sinY, z1 = x*sinY + z*cosY;
        // Rotate X
        var cosX = Math.cos(rotX), sinX = Math.sin(rotX);
        var y1 = y*cosX - z1*sinX, z2 = y*sinX + z1*cosX;
        // Perspective
        var fov = 500, scale = fov / (fov + z2 + 200);
        return { sx: cx/((window.devicePixelRatio>1)?2:1) + x1*scale, sy: cy/((window.devicePixelRatio>1)?2:1) + y1*scale, s:scale, z:z2 };
    }

    function draw(){
        ctx.clearRect(0,0,W,H);
        var t = Date.now() * 0.001;

        // Auto-rotate + mouse influence
        rotY += 0.003 + mouseInfluence * mouseX * 0.01;
        mouseInfluence *= 0.95;

        // Project all nodes
        var projected = nodes.map(function(n){ return project(n.x, n.y, n.z); });

        // Draw edges (synapses)
        for(var i=0; i<edges.length; i++){
            var e = edges[i];
            var pa = projected[e.a], pb = projected[e.b];
            var avgZ = (pa.z + pb.z) / 2;
            var alpha = Math.max(0, Math.min(0.2, (200-avgZ)/800 * 0.25));
            ctx.strokeStyle = 'rgba(41,151,255,' + alpha + ')';
            ctx.lineWidth = 0.6;
            ctx.beginPath();
            ctx.moveTo(pa.sx, pa.sy);
            ctx.lineTo(pb.sx, pb.sy);
            ctx.stroke();
        }

        // Draw signals
        for(var i=signals.length-1; i>=0; i--){
            var s = signals[i];
            s.t += s.speed;
            if(s.t > 1){ signals.splice(i,1); continue; }
            var na = nodes[s.edge.a], nb = nodes[s.edge.b];
            var tt = s.dir > 0 ? s.t : 1-s.t;
            var sx = na.x + (nb.x-na.x)*tt;
            var sy = na.y + (nb.y-na.y)*tt;
            var sz = na.z + (nb.z-na.z)*tt;
            var sp = project(sx, sy, sz);
            var sAlpha = Math.sin(s.t * Math.PI) * 0.9;
            ctx.fillStyle = 'rgba(100,210,255,' + sAlpha + ')';
            ctx.shadowColor = '#64d2ff';
            ctx.shadowBlur = 8;
            ctx.beginPath();
            ctx.arc(sp.sx, sp.sy, 2.5*sp.s, 0, Math.PI*2);
            ctx.fill();
            ctx.shadowBlur = 0;
        }

        // Draw nodes sorted by depth
        var indices = [];
        for(var i=0; i<N; i++) indices.push(i);
        indices.sort(function(a,b){ return projected[a].z - projected[b].z; });

        for(var k=0; k<indices.length; k++){
            var i = indices[k];
            var n = nodes[i], p = projected[i];
            var pulse = Math.sin(t*1.5 + n.pulse) * 0.5 + 0.5;
            var r = n.baseR * p.s;
            var zAlpha = Math.max(0.15, Math.min(0.85, (200-p.z)/400));

            if(n.active){
                // Glow
                ctx.shadowColor = '#2997ff';
                ctx.shadowBlur = 12 * p.s;
                ctx.fillStyle = 'rgba(41,151,255,' + (zAlpha * (0.6+pulse*0.4)) + ')';
                ctx.beginPath();
                ctx.arc(p.sx, p.sy, r*(1+pulse*0.3), 0, Math.PI*2);
                ctx.fill();
                ctx.shadowBlur = 0;
            } else {
                ctx.fillStyle = 'rgba(41,151,255,' + (zAlpha*0.35) + ')';
                ctx.beginPath();
                ctx.arc(p.sx, p.sy, r, 0, Math.PI*2);
                ctx.fill();
            }
        }

        requestAnimationFrame(draw);
    }

    // Start when visible
    var started = false;
    var obs = new IntersectionObserver(function(ents){
        if(ents[0].isIntersecting && !started){ started=true; draw(); }
    }, {threshold:0.2});
    obs.observe(c);
})();
</script>

// ‚ïê‚ïê‚ïê HELIOS FORTUNE SPIN ENGINE ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
(function() {
    var prizes = [
        { label:'2√ó Token\nBonus',    icon:'üèÜ', color:'#d97706', title:'2√ó Token Bonus!',         desc:'Your HLS token allocation is doubled on your next activation. Founding price + double tokens = maximum value.' },
        { label:'Gold Cert\nUpgrade', icon:'ü™ô', color:'#2997ff', title:'Gold Certificate Upgrade!', desc:'Receive a premium gold certificate ‚Äî one tier above your contract level. Physical gold backing, amplified.' },
        { label:'Silver Cert\nBonus', icon:'ü•à', color:'#64d2ff', title:'Silver Certificate Bonus!', desc:'A bonus silver-class certificate added to your portfolio. Stack certificates. Stack value.' },
        { label:'NFT Drop\nExclusive',icon:'üé®', color:'#bf5af2', title:'Exclusive NFT Drop!',       desc:'A limited-edition Helios founding NFT ‚Äî minted on XRPL. Only available during the Founding Window.' },
        { label:'+5% Staking\nReward',icon:'üìà', color:'#34d399', title:'+5% Staking Reward!',       desc:'Your certificate staking yield increases by 5% for the first 12 months. Passive returns, amplified.' },
        { label:'Founding\nBonus Lock',icon:'üîí', color:'#fbbf24', title:'Founding Bonus Lock!',     desc:'Your founding multiplier is locked permanently ‚Äî even if you upgrade contracts later. 10√ó forever.' },
        { label:'Early Access\nPass',  icon:'üî•', color:'#f43f5e', title:'Early Access Pass!',       desc:'Priority access to Phase 2 features: advanced staking tiers, marketplace, and governance voting.' },
        { label:'Double\nAllocation',  icon:'üí∞', color:'#22c55e', title:'Double Allocation!',       desc:'Your smart contract allocation pool contribution is doubled. Twice the propagation power in your mesh.' }
    ];

    var canvas = document.getElementById('fortune-wheel');
    if (!canvas) return;
    var ctx = canvas.getContext('2d');
    var cx = 160, cy = 160, r = 150;
    var sliceAngle = (2 * Math.PI) / prizes.length;
    var currentAngle = 0;
    var spinning = false;

    function drawWheel(rotation) {
        ctx.clearRect(0, 0, 320, 320);
        for (var i = 0; i < prizes.length; i++) {
            var startAngle = rotation + i * sliceAngle;
            var endAngle = startAngle + sliceAngle;

            // Slice
            ctx.beginPath();
            ctx.moveTo(cx, cy);
            ctx.arc(cx, cy, r, startAngle, endAngle);
            ctx.closePath();
            ctx.fillStyle = prizes[i].color;
            ctx.globalAlpha = 0.85;
            ctx.fill();
            ctx.globalAlpha = 1;
            ctx.strokeStyle = 'rgba(0,0,0,0.3)';
            ctx.lineWidth = 2;
            ctx.stroke();

            // Label
            ctx.save();
            ctx.translate(cx, cy);
            ctx.rotate(startAngle + sliceAngle / 2);
            ctx.textAlign = 'center';
            ctx.fillStyle = '#fff';
            ctx.font = 'bold 11px Inter, sans-serif';
            var lines = prizes[i].label.split('\n');
            for (var l = 0; l < lines.length; l++) {
                ctx.fillText(lines[l], r * 0.62, 4 + (l - (lines.length-1)/2) * 14);
            }
            ctx.restore();
        }
        // Center circle
        ctx.beginPath();
        ctx.arc(cx, cy, 28, 0, 2 * Math.PI);
        ctx.fillStyle = '#0a0a0c';
        ctx.fill();
        ctx.strokeStyle = 'var(--gold)';
        ctx.lineWidth = 2;
        ctx.stroke();
        ctx.fillStyle = '#fbbf24';
        ctx.font = 'bold 16px Inter, sans-serif';
        ctx.textAlign = 'center';
        ctx.textBaseline = 'middle';
        ctx.fillText('‚òÄÔ∏è', cx, cy);
    }

    drawWheel(0);

    window.spinWheel = function() {
        if (spinning) return;
        var played = sessionStorage.getItem('helios_spin_played');
        if (played) {
            document.getElementById('spin-status').textContent = 'You already claimed your spin! Activate to lock in your bonus.';
            return;
        }

        spinning = true;
        var btn = document.getElementById('spin-btn');
        btn.style.opacity = '0.5';
        btn.textContent = 'Spinning...';
        document.getElementById('spin-status').textContent = '';
        document.getElementById('prize-reveal').style.display = 'none';

        // Weighted: slight bias toward good-but-not-best prizes
        var weights = [8, 15, 18, 12, 18, 10, 12, 7]; // Double alloc & 2x token are rarer
        var totalWeight = 0;
        for (var w = 0; w < weights.length; w++) totalWeight += weights[w];
        var rand = Math.random() * totalWeight;
        var winIndex = 0;
        var cumulative = 0;
        for (var w = 0; w < weights.length; w++) {
            cumulative += weights[w];
            if (rand < cumulative) { winIndex = w; break; }
        }

        // Calculate target angle: pointer is at top (270deg = -PI/2)
        // Prize i is centered at i*sliceAngle + sliceAngle/2
        // We need the prize center to align with -PI/2
        var targetSliceCenter = winIndex * sliceAngle + sliceAngle / 2;
        var targetAngle = -Math.PI / 2 - targetSliceCenter;
        // Add 5-8 full rotations for drama
        var spins = 5 + Math.floor(Math.random() * 3);
        var totalRotation = spins * 2 * Math.PI + (targetAngle - currentAngle % (2 * Math.PI));

        var startTime = null;
        var duration = 4000 + Math.random() * 1000;
        var startAngle = currentAngle;

        function animate(timestamp) {
            if (!startTime) startTime = timestamp;
            var elapsed = timestamp - startTime;
            var progress = Math.min(elapsed / duration, 1);
            // Ease out cubic
            var eased = 1 - Math.pow(1 - progress, 3);
            currentAngle = startAngle + totalRotation * eased;
            drawWheel(currentAngle);

            if (progress < 1) {
                requestAnimationFrame(animate);
            } else {
                spinning = false;
                btn.style.opacity = '1';
                btn.textContent = 'üé∞ SPIN TO WIN';
                sessionStorage.setItem('helios_spin_played', '1');
                showPrize(prizes[winIndex]);
            }
        }
        requestAnimationFrame(animate);
    };

    function showPrize(prize) {
        document.getElementById('prize-icon').textContent = prize.icon;
        document.getElementById('prize-title').textContent = prize.title;
        document.getElementById('prize-desc').textContent = prize.desc;
        document.getElementById('prize-reveal').style.display = 'block';
        document.getElementById('spin-status').innerHTML = '<strong style="color:var(--gold);">Bonus unlocked!</strong> Activate your contract to claim it.';

        // Store the prize for the activation flow
        localStorage.setItem('helios_spin_prize', JSON.stringify({
            title: prize.title,
            icon: prize.icon,
            ts: Date.now()
        }));
    }

    // If already spun, show the result
    var stored = localStorage.getItem('helios_spin_prize');
    if (stored && sessionStorage.getItem('helios_spin_played')) {
        try {
            var p = JSON.parse(stored);
            document.getElementById('spin-status').innerHTML = 'You won: <strong style="color:var(--gold);">' + p.title + '</strong> ‚Äî Activate to claim!';
        } catch(e) {}
    }
})();

{% endblock %}
